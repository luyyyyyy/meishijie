/*pub-2016-1-11*/KSLITE.declare("tkapi-plugin-keyword",function(a,b){function c(a){var b=a.innerHTML;return b=b.replace(/[\r\n]/g,""),b=b.replace(/<script.*?>.*?<\/script>/gi,""),b=b.replace(/<style([^>]*)>([^<]*(?:(?!<\/style>)<[^<]*)*)<\/style>/gi,""),b=b.replace(/<noscript([^>]*)>([^<]*(?:(?!<\/noscript>)<[^<]*)*)<\/noscript>/gi,""),b=b.replace(/<[^>]+>/gi,""),b=b.replace(/ /gi,""),b=b.replace(/[\r\n]/g,""),b=b.replace(/\t/g,""),b=b.replace(/&nbsp;/gi,""),b.length}var d=a("tkapi-plugin-api"),f=0,g=[],h=window,i=2,j="ff0000",k=h.location.href;b.Def=function(a){function b(a){var b=new Image,c=new Date;b.onload=b.onabort=b.onerror=function(){b=null},b.src="http://tb.tui.cnzz.net/stat.php?"+a+"&_rnd="+(Date.parse(c)+"."+c.getMilliseconds())}function l(a){function c(a,b,d,e){void 0===r[d]&&(r[d]=[]);var f=b[0],g=b[1];if(a.hasChildNodes&&"TEXTAREA"!=a.tagName&&"INPUT"!=a.tagName&&"A"!=a.tagName&&"BUTTON"!=a.tagName&&"HEAD"!=a.tagName&&"SCRIPT"!=a.tagName&&"STYLE"!=a.tagName){var h;for(h=0;h<a.childNodes.length;h++)c(a.childNodes[h],b,d,e)}3==a.nodeType&&(tempNodeVal=a.nodeValue.toLowerCase(),tempWordVal=f.toLowerCase(),-1!=tempNodeVal.indexOf(tempWordVal)&&(pn=a.parentNode,"tuihighlight"!=pn.className&&(nv=a.nodeValue,ni=tempNodeVal.indexOf(tempWordVal),before=document.createTextNode(nv.substr(0,ni)),docWordVal=nv.substr(ni,f.length),after=document.createTextNode(nv.substr(ni+f.length)),hiwordtext=document.createTextNode(docWordVal),hiword=document.createElement("tuihighlight"),hiword.className="tuihighlight",hiword.style.display="inline",hiword.setAttribute("data_cnzz_tui",g),hiword.appendChild(hiwordtext),pn.insertBefore(before,a),pn.insertBefore(hiword,a),pn.insertBefore(after,a),pn.removeChild(a),void 0===r[d][e]&&(r[d][e]=!0))))}function d(a,b){function c(a){for(var c=0;c<a.length;c++){var d="#",e=document.createElement("a");e.href=d,e.style.cssText="display:inline;color:#"+j,e.setAttribute("data-keyword",a[c].getAttribute("data_cnzz_tui")),e.setAttribute("data-type",2),e.setAttribute("data-style",1),e.setAttribute("data-tmpl","290x380"),e.setAttribute("data-tmplid","52"),e.target="_blank",e.innerHTML=a[c].innerHTML,a[c].innerHTML="",a[c].appendChild(e),s[b]+=1}}function d(a){for(var b,c=[],d={},e=a.length,f=e,g=1;--e>=0&&i>=g;)b=Math.floor(Math.random()*f),void 0===d[b]?(c[c.length]=d[b]=a[b],g++):e++;return c}s[b]=0;for(var e,f=a.getElementsByTagName("TUIHIGHLIGHT"),g={},h=0;h<f.length;h++)e=f[h].innerHTML,g[e]?g[e].push(f[h]):g[e]=[f[h]];for(h in g)c(g[h].length<=i?g[h]:d(g[h]))}function f(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}var k,l,m,o=new Date,p=o.getTime()-n.getTime(),q=(h.location.href.split("/")[2],{}),r={},s={},t=a.d.length,u=g.length;if(a.d.length<0)m=a.r+"&l=nodata&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer)+"&atm="+p,b(m);else for(k=0;k<g.length;k++)if(a.d[k]&&a.d[k][0]){for(l=0;l<a.d[k].length;l++)c(g[k],a.d[k][l],k,l);q[k]=a.d[k].length}else q[k]=0;for(k in r)if(r[k].length){var v=0;for(l=0;l<r[k].length;l++)r[k][l]&&v++;r[k]=v}else r[k]=0;for(k=0;k<g.length;k++)d(g[k],k);if(a.d.length>0){for(m=a.r+"&l=load&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer)+"&atm="+p+"&ressct="+t+"&htmsct="+u,k=0;t>k;k++){var w="";void 0===q[k]&&(q[k]=0),void 0===s[k]&&(s[k]=0),void 0===r[k]&&(r[k]=0),w+=0===k?"&%01":"&%02",w+="&rescnt="+q[k]+"&hit="+r[k]+"&high="+s[k],m+=w}b(m)}else m=a.r+"&l=nodata&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer),b(m);for(k=0;k<g.length;k++){var x=g[k].getElementsByTagName("a");for(l=0;l<x.length;l++)x[l].idx=l,x[l].par=k,x[l].getAttribute("data-keyword")&&(f(x[l],"mouseover",function(){e=window.event||e;var c=e.srcElement||e.target,d=encodeURIComponent(c.innerHTML)||"",f=encodeURIComponent(c.getAttribute("data-keyword")||""),g=c.par,i=c.idx,j=a.r+"&l=over&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer)+"&wd="+d+"&kwd="+f+"&sct="+(g+1)+"&idx="+(i+1);b(j)}),f(x[l],"click",function(){e=window.event||e;var c=e.srcElement||e.target,d=encodeURIComponent(c.innerHTML)||"",f=encodeURIComponent(c.getAttribute("data-keyword")||""),g=c.par,i=c.idx,j=a.r+"&l=click&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer)+"&wd="+d+"&kwd="+f+"&sct="+(g+1)+"&idx="+(i+1);b(j)}))}}g=d.getElementsFor("keyword");for(var m=0;m<g.length;m++)f+=c(g[m]);var n=new Date;d.util.jsonpGet("http://tui.cnzz.net/jsonp.php?surl="+encodeURIComponent(k)+"&num="+f,!1,{cbKey:"callback",queryOrder:[],timeout:6e3,onCallback:function(a,c){if("Timeout"==c){var d=new Date,e=d.getTime()-n.getTime(),f=encodeURIComponent(h.location.href.split("/")[2]),g="l=timeout&purl="+encodeURIComponent(h.location.href)+"&oref="+encodeURIComponent(document.referrer)+"&atm="+e+"&sid="+f;b(g)}else l(a)}}),a()}});